<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:models="using:ShareX.Editor.Annotations"
             xmlns:converters="using:ShareX.Editor.Converters"
             xmlns:controls="using:ShareX.Editor.Controls"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="56"
             x:Class="ShareX.Editor.Views.Controls.AnnotationToolbar"
             x:Name="AnnotationToolbarRoot">

    <UserControl.Resources>
        <converters:EqualsConverter x:Key="EqualsConverter" />
        <FontFamily x:Key="FontAwesome">avares://ShareX.Editor/Assets#Font Awesome 7 Free</FontFamily>
        <x:String x:Key="IconSelect">&#xf25a;</x:String>
        <x:String x:Key="IconRectangle">&#xf0c8;</x:String>
        <x:String x:Key="IconEllipse">&#xf111;</x:String>
        <x:String x:Key="IconLine">&#xf068;</x:String>
        <x:String x:Key="IconArrow">&#xf061;</x:String>
        <x:String x:Key="IconPen">&#xf304;</x:String>
        <x:String x:Key="IconHighlighter">&#xf591;</x:String>
        <x:String x:Key="IconText">&#xf031;</x:String>
        <x:String x:Key="IconSpeechBalloon">&#xf4ad;</x:String>
        <x:String x:Key="IconNumber">&#xf0cb;</x:String>
        <x:String x:Key="IconBlur">&#xf1fc;</x:String>
        <x:String x:Key="IconPixelate">&#xf009;</x:String>
        <x:String x:Key="IconMagnify">&#xf00e;</x:String>
        <x:String x:Key="IconSpotlight">&#xf0eb;</x:String>
        <x:String x:Key="IconSmartEraser">&#xf12d;</x:String>
        <x:String x:Key="IconUndo">&#xf0e2;</x:String>
        <x:String x:Key="IconRedo">&#xf01e;</x:String>
        <x:String x:Key="IconClear">&#xf12d;</x:String>
        <x:String x:Key="IconDelete">&#xf2ed;</x:String>
        <x:String x:Key="IconMoon">&#xf186;</x:String>

        <SolidColorBrush x:Key="TextColor">#E7E9EA</SolidColorBrush>
        <LinearGradientBrush x:Key="AccentColor" StartPoint="0%,0%" EndPoint="100%,100%">
            <GradientStop Color="#3E83F2" Offset="0"/>
            <GradientStop Color="#3975D5" Offset="1"/>
        </LinearGradientBrush>
    </UserControl.Resources>

    <UserControl.Styles>
        <Style Selector="Button.editor-button">
            <Setter Property="MinWidth" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Background" Value="#2E2E2E"/>
            <Setter Property="BorderBrush" Value="#1F1F1F"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor}"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>

            <Style Selector="^:pointerover /template/ ContentPresenter#PART_ContentPresenter">
                <Setter Property="BorderBrush" Value="#1F1F1F"/>
                <Setter Property="BorderThickness" Value="1"/>
            </Style>

            <Style Selector="^:pressed">
                <Setter Property="RenderTransform" Value="none"/>
            </Style>

            <Style Selector="^:pressed /template/ ContentPresenter#PART_ContentPresenter">
                <Setter Property="BorderBrush" Value="#1F1F1F"/>
                <Setter Property="BorderThickness" Value="1"/>
            </Style>

            <Style Selector="^.active">
                <Setter Property="Background" Value="{StaticResource AccentColor}"/>
            </Style>
        </Style>
    </UserControl.Styles>

    <Border Padding="0" Background="#222222" BorderBrush="#1F1F1F" BorderThickness="0,0,0,1">
        <ScrollViewer x:Name="ToolbarScrollViewer" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
            <StackPanel Orientation="Horizontal" Spacing="4" Margin="0,8,8,8">
                <!-- Drawing Tools -->
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Select}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Select}"
                        ToolTip.Tip="Select (V)"
                        AutomationProperties.Name="Select Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconSelect}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Rectangle}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Rectangle}"
                        ToolTip.Tip="Rectangle (R)"
                        AutomationProperties.Name="Rectangle Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconRectangle}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Ellipse}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Ellipse}"
                        ToolTip.Tip="Ellipse (E)"
                        AutomationProperties.Name="Ellipse Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconEllipse}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Line}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Line}"
                        ToolTip.Tip="Line (L)"
                        AutomationProperties.Name="Line Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconLine}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Arrow}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Arrow}"
                        ToolTip.Tip="Arrow (A)"
                        AutomationProperties.Name="Arrow Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconArrow}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Pen}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Pen}"
                        ToolTip.Tip="Freehand (P)"
                        AutomationProperties.Name="Freehand Pen Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconPen}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Highlighter}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Highlighter}"
                        ToolTip.Tip="Highlighter (H)"
                        AutomationProperties.Name="Highlighter Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconHighlighter}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Text}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Text}"
                        ToolTip.Tip="Text (T)"
                        AutomationProperties.Name="Text Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconText}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=SpeechBalloon}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.SpeechBalloon}"
                        ToolTip.Tip="Speech Balloon (B)"
                        AutomationProperties.Name="Speech Balloon Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconSpeechBalloon}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Number}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Number}"
                        ToolTip.Tip="Step/Number (N)"
                        AutomationProperties.Name="Step Number Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconNumber}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Blur}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Blur}"
                        ToolTip.Tip="Blur Region"
                        AutomationProperties.Name="Blur Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconBlur}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Pixelate}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Pixelate}"
                        ToolTip.Tip="Pixelate Region"
                        AutomationProperties.Name="Pixelate Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconPixelate}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Magnify}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Magnify}"
                        ToolTip.Tip="Magnifier (M)"
                        AutomationProperties.Name="Magnifier Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconMagnify}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=Spotlight}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.Spotlight}"
                        ToolTip.Tip="Spotlight (S)"
                        AutomationProperties.Name="Spotlight Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconSpotlight}"/>
                <Button Classes="editor-button"
                        Classes.active="{Binding ActiveTool, Converter={StaticResource EqualsConverter}, ConverterParameter=SmartEraser}"
                        Command="{Binding SelectToolCommand}" CommandParameter="{x:Static models:EditorTool.SmartEraser}"
                        ToolTip.Tip="Smart Eraser"
                        AutomationProperties.Name="Smart Eraser Tool"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconSmartEraser}"/>

                <!-- Extension Content Slot (for EditorToolsPanel in Editor mode) -->
                <ContentPresenter x:Name="ExtensionContentPresenter" Content="{Binding ExtensionContent, ElementName=AnnotationToolbarRoot}"/>

                <!-- Separator -->
                <Border Width="1" Height="40" Background="#2E2E2E" Margin="4,0"/>

                <!-- Border Color Picker Dropdown -->
                <controls:ColorPickerDropdown x:Name="ColorPickerDropdown"
                    SelectedColor="{Binding SelectedColorBrush}"
                    Height="40"
                    IsVisible="{Binding ShowBorderColor}"
                    ToolTip.Tip="Border Color"/>

                <!-- Fill Color Picker Dropdown -->
                <controls:ColorPickerDropdown x:Name="FillColorPickerDropdown"
                    SelectedColor="{Binding FillColorBrush}"
                    Height="40"
                    IsVisible="{Binding ShowFillColor}"
                    ToolTip.Tip="Fill Color"/>

                <!-- Thickness Picker Dropdown -->
                <controls:WidthPickerDropdown
                    SelectedWidth="{Binding StrokeWidth}"
                    Height="40"
                    IsVisible="{Binding ShowThickness}"
                    ToolTip.Tip="Thickness"/>

                <!-- Font Size Picker Dropdown -->
                <controls:FontSizePickerDropdown
                    SelectedFontSize="{Binding FontSize}"
                    Height="40"
                    IsVisible="{Binding ShowFontSize}"
                    ToolTip.Tip="Font Size"/>

                <!-- Strength Slider -->
                <controls:StrengthSlider
                    SelectedStrength="{Binding EffectStrength}"
                    IsVisible="{Binding ShowStrength}"
                    ToolTip.Tip="Effect Strength"/>

                <!-- Shadow Toggle Button -->
                <Button x:Name="ShadowToggleButton" Classes="editor-button" Width="40" Height="40"
                        Classes.active="{Binding ShadowEnabled}"
                        Click="OnShadowButtonClicked"
                        IsVisible="{Binding ShowShadow}"
                        ToolTip.Tip="Toggle Shadow"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconMoon}"/>

                <!-- Separator -->
                <Border Width="1" Height="40" Background="#2E2E2E" Margin="4,0"/>

                <!-- Undo Button -->
                <Button Classes="editor-button"
                        Command="{Binding UndoCommand}" ToolTip.Tip="Undo (Ctrl+Z)"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconUndo}"/>

                <!-- Redo Button -->
                <Button Classes="editor-button" Width="40" Height="40"
                        Command="{Binding RedoCommand}" ToolTip.Tip="Redo (Ctrl+Y)"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconRedo}"/>

                <!-- Separator -->
                <Border Width="1" Height="40" Background="#2E2E2E" Margin="4,0"/>

                <!-- Delete Button -->
                <Button Classes="editor-button" Width="40" Height="40"
                        Command="{Binding DeleteSelectedCommand}" ToolTip.Tip="Delete Selected (Del)"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconDelete}"/>

                <!-- Clear Button -->
                <Button Classes="editor-button"
                        Command="{Binding ClearAnnotationsCommand}" ToolTip.Tip="Clear all annotations"
                        FontFamily="{StaticResource FontAwesome}" FontWeight="Black" FontSize="16" Content="{StaticResource IconClear}"/>
            </StackPanel>
        </ScrollViewer>
    </Border>
</UserControl>
